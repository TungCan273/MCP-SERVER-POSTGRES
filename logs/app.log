[2025-12-17 10:12:35] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:12:35] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:12:35] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:12:35] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:12:35] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:12:47] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:12:49] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:12:49] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:12:49] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:17:09] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:17:09] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:17:11] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:17:11] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:17:11] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:17:11] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:17:11] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:17:21] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:17:21] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:17:21] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:18:30] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:18:30] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT p.content, p.title FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post_id WHERE l.p...
[2025-12-17 10:18:36] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 10:19:40] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:20:03] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:20:03] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:20:04] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:20:04] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:20:04] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:20:04] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:20:04] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:20:12] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:20:12] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:20:12] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:20:52] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:20:52] [ERROR] [trace_id=-] [postgres.py:439] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 10:31:37] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:32:20] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:32:20] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:32:21] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:32:21] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:32:21] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:32:21] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:32:21] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:32:29] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:32:29] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:32:29] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:33:27] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:33:27] [ERROR] [trace_id=-] [postgres.py:439] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 10:34:55] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:35:26] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:35:26] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:35:28] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:35:28] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:35:28] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:35:28] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:35:28] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:35:37] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:35:37] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:35:37] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:36:37] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:36:37] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-17 10:36:42] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 10:38:14] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:38:14] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-17 10:38:20] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 10:38:22] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:38:22] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-17 10:38:25] [ERROR] [trace_id=-] [local_sentiment_model.py:85] - ❌ Error loading model: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:38:25] [ERROR] [trace_id=-] [local_sentiment_model.py:244] - Tool call failed: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:38:29] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:38:29] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-17 10:38:30] [ERROR] [trace_id=-] [local_sentiment_model.py:85] - ❌ Error loading model: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:38:30] [ERROR] [trace_id=-] [local_sentiment_model.py:244] - Tool call failed: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:43:17] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:43:17] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-17 10:43:20] [ERROR] [trace_id=-] [local_sentiment_model.py:85] - ❌ Error loading model: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:43:20] [ERROR] [trace_id=-] [local_sentiment_model.py:244] - Tool call failed: Using a `device_map`, `tp_plan`, `torch.device` context manager or setting `torch.set_default_device(device)` requires `accelerate`. You can install it with `pip install accelerate`
[2025-12-17 10:44:31] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:44:54] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:44:54] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:44:56] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:44:56] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:44:56] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:44:56] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:44:56] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:45:03] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:45:03] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:45:03] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:53:06] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:53:33] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:53:33] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:53:35] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:53:35] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:53:35] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:53:35] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:53:35] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:53:43] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:53:43] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:53:43] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:54:00] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 10:54:40] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 10:54:40] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 10:54:42] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 10:54:42] [INFO] [trace_id=-] [postgres.py:608] - Starting postgres-mcp-server...
[2025-12-17 10:54:42] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 10:54:42] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 10:54:42] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 10:54:52] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 10:54:52] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:54:52] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 10:55:36] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:55:36] [ERROR] [trace_id=-] [postgres.py:439] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 10:56:25] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:56:25] [ERROR] [trace_id=-] [postgres.py:439] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 10:56:27] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:56:27] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
    ...
[2025-12-17 10:56:32] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 10:57:09] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:57:09] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-17 10:57:29] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:57:29] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-17 10:57:30] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-17 10:57:33] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:57:34] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7826)
[2025-12-17 10:57:36] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:57:37] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9493)
[2025-12-17 10:57:40] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:57:41] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.4983)
[2025-12-17 10:58:18] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 10:58:18] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-17 10:58:23] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 10:58:24] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:58:25] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-17 10:58:26] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 10:58:27] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-17 11:50:54] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 11:50:55] [INFO] [trace_id=-] [postgres.py:639] - Connection pool closed
[2025-12-17 15:50:33] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 15:50:33] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 15:50:35] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 15:50:35] [INFO] [trace_id=-] [postgres.py:652] - Starting postgres-mcp-server...
[2025-12-17 15:50:35] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 15:50:39] [ERROR] [trace_id=-] [postgres.py:68] - Failed to refresh schema cache: 'table_schema'
[2025-12-17 15:50:39] [ERROR] [trace_id=-] [postgres.py:677] - Server error: 'table_schema'
[2025-12-17 15:50:39] [INFO] [trace_id=-] [postgres.py:683] - Connection pool closed
[2025-12-17 15:50:53] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 15:50:53] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 15:50:53] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 15:51:18] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 15:51:18] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 15:51:20] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 15:51:20] [INFO] [trace_id=-] [postgres.py:652] - Starting postgres-mcp-server...
[2025-12-17 15:51:20] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 15:51:26] [ERROR] [trace_id=-] [postgres.py:68] - Failed to refresh schema cache: 'table_schema'
[2025-12-17 15:51:26] [ERROR] [trace_id=-] [postgres.py:677] - Server error: 'table_schema'
[2025-12-17 15:51:26] [INFO] [trace_id=-] [postgres.py:683] - Connection pool closed
[2025-12-17 15:51:43] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 15:51:43] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 15:51:43] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:12:29] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:12:29] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:12:31] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:12:31] [INFO] [trace_id=-] [postgres.py:652] - Starting postgres-mcp-server...
[2025-12-17 16:12:31] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:12:36] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:12:36] [INFO] [trace_id=-] [postgres.py:652] - Starting postgres-mcp-server...
[2025-12-17 16:12:36] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:12:36] [ERROR] [trace_id=-] [postgres.py:68] - Failed to refresh schema cache: 'table_schema'
[2025-12-17 16:12:36] [ERROR] [trace_id=-] [postgres.py:677] - Server error: 'table_schema'
[2025-12-17 16:12:36] [INFO] [trace_id=-] [postgres.py:683] - Connection pool closed
[2025-12-17 16:12:41] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:12:41] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:12:41] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:12:41] [ERROR] [trace_id=-] [postgres.py:68] - Failed to refresh schema cache: 'table_schema'
[2025-12-17 16:12:41] [ERROR] [trace_id=-] [postgres.py:677] - Server error: 'table_schema'
[2025-12-17 16:12:41] [INFO] [trace_id=-] [postgres.py:683] - Connection pool closed
[2025-12-17 16:12:44] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:12:44] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:12:44] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:12:48] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:14:27] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:14:27] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:14:27] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:14:27] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:14:27] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:15:06] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:15:06] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:15:07] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:15:07] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:15:07] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:15:07] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:15:07] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:15:20] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:15:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:15:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:16:11] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:16:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:16:12] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:16:12] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:16:12] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:16:12] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:16:12] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:16:28] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:16:28] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:16:28] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:16:28] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:16:28] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:16:30] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 16:18:52] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:18:52] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:18:54] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:18:54] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:18:54] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:18:54] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:18:54] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:19:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:19:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:19:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:19:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:19:04] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:19:05] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:19:05] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:19:08] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 16:38:55] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:38:59] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:39:01] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:39:01] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:39:01] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:39:01] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:39:01] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:39:11] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:39:11] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:39:11] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:39:11] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:39:11] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:39:11] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:39:11] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:39:12] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 16:48:22] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 16:48:22] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 16:48:24] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 16:48:24] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 16:48:24] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 16:48:24] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 16:48:24] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 16:48:33] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 16:48:33] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 16:48:33] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 16:48:33] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:48:33] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:48:33] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-17 16:48:33] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-17 16:48:34] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 17:14:58] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 17:16:12] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 17:16:12] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 17:16:13] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 17:16:13] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 17:16:13] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 17:16:13] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 17:16:13] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 17:16:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 17:16:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 17:16:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 17:20:25] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 17:20:56] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 17:20:56] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 17:20:58] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 17:20:58] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 17:20:58] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 17:20:58] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 17:20:58] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 17:21:06] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 17:21:06] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 17:21:06] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 17:22:29] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 17:23:16] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 17:23:16] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 17:23:18] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 17:23:18] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 17:23:18] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 17:23:18] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 17:23:18] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 17:23:28] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 17:23:28] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 17:23:28] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-17 17:23:48] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:23:48] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 17:23:50] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:23:50] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-17 17:23:56] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 17:24:46] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:24:46] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT DISTINCT p.content FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post_id WHERE l.p...
[2025-12-17 17:24:52] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 17:25:25] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:25:25] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT DISTINCT p.content
FROM tbl_posts p
JOIN tbl_trans_detail_log l ON p.id = l.post_id
WHERE l.p...
[2025-12-17 17:25:32] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 17:26:30] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:26:30] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l ON p...
[2025-12-17 17:26:36] [INFO] [trace_id=-] [postgres.py:256] - Query returned 20 rows
[2025-12-17 17:27:03] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:27:03] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-17 17:27:07] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-17 17:27:07] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l ON p...
[2025-12-17 17:27:12] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-17 17:29:02] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-17 17:30:10] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-17 17:30:10] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-17 17:30:11] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-17 17:30:11] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-17 17:30:11] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-17 17:30:11] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-17 17:30:11] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-17 17:30:19] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-17 17:30:19] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-17 17:30:19] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 09:06:49] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 09:06:49] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 09:06:51] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 09:06:51] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 09:06:51] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 09:06:51] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 09:06:51] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 09:06:59] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 09:06:59] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 09:06:59] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 09:07:28] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 09:07:28] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 09:07:30] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 09:07:30] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 09:07:30] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 09:07:30] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 09:07:30] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 09:07:37] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 09:07:37] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 09:07:37] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 09:07:37] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 09:07:37] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 09:07:37] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 09:07:37] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 09:07:38] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 09:40:26] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 09:40:49] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 09:40:49] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 09:40:50] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 09:40:50] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 09:40:50] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 09:40:50] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 09:40:50] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 09:40:58] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 09:40:58] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 09:40:58] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 09:43:37] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 09:43:51] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 09:43:51] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 09:43:53] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 09:43:53] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 09:43:53] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 09:43:53] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 09:43:53] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 09:44:03] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 09:44:03] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 09:44:03] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 09:47:06] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 09:47:24] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 09:47:24] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 09:47:26] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 09:47:26] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 09:47:26] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 09:47:26] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 09:47:26] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 09:47:34] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 09:47:34] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 09:47:34] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 10:03:06] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 10:03:28] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 10:03:28] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 10:03:30] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 10:03:30] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 10:03:49] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 10:03:49] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 10:03:49] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 10:04:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 10:04:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 10:04:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 10:41:05] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 10:47:01] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 10:47:01] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 10:47:01] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 10:47:01] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 10:47:03] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 10:47:12] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 10:47:12] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 10:47:12] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 10:47:12] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 10:47:12] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 10:47:12] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 10:47:12] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 10:47:13] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 10:53:00] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 10:56:08] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 10:56:08] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 10:56:10] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 10:56:10] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 10:56:10] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 10:56:10] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 10:56:10] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 10:56:20] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 10:56:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 10:56:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 10:58:16] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 10:58:37] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 10:58:37] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 10:58:38] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 10:58:38] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 10:58:38] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 10:58:38] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 10:58:38] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 10:58:46] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 10:58:46] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 10:58:46] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:00:30] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:01:46] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:01:46] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:01:47] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:01:47] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:01:47] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:01:47] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:01:47] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:01:56] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:01:56] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:01:56] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:03:16] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:04:21] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:04:21] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:04:23] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:04:23] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:04:23] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:04:23] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:04:23] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:04:37] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:04:37] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:04:37] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:06:44] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:09:40] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:09:40] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:09:42] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:09:42] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:09:42] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:09:42] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:09:42] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:09:50] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:09:50] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:09:50] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:11:17] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:13:43] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:13:43] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:13:46] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:13:46] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:13:46] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:13:46] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:13:46] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:13:55] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:13:55] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:13:55] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:17:38] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:17:59] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:17:59] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:18:00] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:18:00] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:18:01] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:18:01] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:18:01] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:18:09] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:18:09] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:18:09] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:18:47] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:19:11] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:19:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:19:13] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:19:13] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:19:13] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:19:13] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:19:13] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:19:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:19:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:19:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:21:55] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:25:18] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:25:18] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:25:20] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:25:20] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:25:20] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:25:20] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:25:20] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:25:30] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:25:30] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:25:30] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:32:13] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:32:55] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:32:55] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:32:57] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:32:57] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:32:57] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:32:57] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:32:57] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:33:05] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:33:05] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:33:05] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:37:34] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:39:16] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:39:16] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:39:18] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:39:18] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:39:18] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:39:18] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:39:18] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:39:29] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:39:29] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:39:29] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:44:15] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:45:10] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:45:10] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:45:12] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:45:12] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:45:12] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:45:12] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:45:12] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:45:20] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:45:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:45:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:48:22] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:51:37] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:51:37] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:51:38] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:51:38] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:51:38] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:51:38] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:51:38] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:51:46] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:51:46] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:51:46] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 11:51:46] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 11:52:01] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 11:52:01] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 11:52:03] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 11:52:03] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 11:52:03] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 11:52:03] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 11:52:03] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 11:52:10] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 11:52:10] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 11:52:10] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:09:32] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:10:11] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:10:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:10:12] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:10:12] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:10:12] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:10:13] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:10:13] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:10:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:10:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:10:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:12:06] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:15:38] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:15:38] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:15:40] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:15:40] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:15:41] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:15:41] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:15:41] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:16:14] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:16:14] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:16:14] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:18:37] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:19:52] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:20:00] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:20:07] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:20:07] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:20:07] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:20:07] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:20:07] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:20:33] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:20:33] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:20:33] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:31:04] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:31:35] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:31:35] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:31:37] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:31:37] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:31:37] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:31:37] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:31:37] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:31:47] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:31:47] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:31:47] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:32:31] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:32:31] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:34:35] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:34:35] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:34:38] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:34:38] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:34:43] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:34:43] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:35:07] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:35:07] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:35:09] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:35:09] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:35:13] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:35:13] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 14:35:17] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:35:17] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 14:35:18] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.8200)
[2025-12-18 14:35:24] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 14:35:24] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT content, sentiment FROM tbl_post;...
[2025-12-18 14:35:24] [ERROR] [trace_id=-] [postgres.py:260] - Database error executing query: relation "tbl_post" does not exist
LINE 1: SELECT content, sentiment FROM tbl_post;
                                       ^

[2025-12-18 14:35:24] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Lỗi thực thi query: relation "tbl_post" does not exist
LINE 1: SELECT content, sentiment FROM tbl_post;
                                       ^

[2025-12-18 14:35:25] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:35:25] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:36:03] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:36:03] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:36:05] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:36:05] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:36:09] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:36:09] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:36:12] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:36:12] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:40:26] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:40:52] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:40:52] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:40:53] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:40:53] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:40:53] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:40:53] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:40:53] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:41:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:43:37] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:45:21] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:45:21] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:45:24] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:45:24] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:45:24] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:45:24] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:45:24] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:45:37] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:45:37] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:45:37] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:47:22] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:47:22] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:47:27] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:47:27] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:47:30] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:47:40] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:47:40] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:48:01] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:48:01] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:48:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:48:04] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:48:11] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:48:11] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:49:26] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:49:26] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 14:49:29] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:49:29] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 14:49:31] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9994)
[2025-12-18 14:49:42] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:49:42] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:54:29] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 14:54:52] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 14:54:52] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 14:54:53] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 14:54:53] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 14:54:53] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 14:54:53] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 14:54:53] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 14:55:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 14:55:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:55:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 14:55:41] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:55:41] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 14:55:44] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:55:44] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 14:55:46] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9959)
[2025-12-18 14:55:52] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:55:52] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:24] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:24] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:27] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:27] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:31] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:31] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:39] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:39] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:40] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:40] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 14:56:43] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 14:56:43] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7084)
[2025-12-18 14:56:56] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 14:56:56] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:08:22] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 15:08:54] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:08:54] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:08:55] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:08:55] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:08:55] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:08:55] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:08:55] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:09:03] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:09:03] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:09:03] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:10:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:10:16] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:10:22] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:10:22] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:10:24] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:10:24] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 15:10:27] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:10:27] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 15:10:29] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7084)
[2025-12-18 15:10:31] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:10:31] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:10:54] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:10:54] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:10:58] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:10:58] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:11:00] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:11:01] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7084)
[2025-12-18 15:11:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:11:04] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:11:34] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:11:34] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:11:37] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:11:37] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:12:09] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:12:09] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:12:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:12:16] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:12:23] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 15:12:23] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 15:12:30] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 15:12:34] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:12:34] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:13:36] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 15:16:04] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:16:04] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:16:06] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:16:06] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:16:06] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:16:06] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:16:06] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:16:15] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:16:15] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:16:15] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:16:16] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 15:17:30] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:17:31] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:17:34] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:17:34] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:17:34] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:17:34] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:17:34] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:17:42] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:17:42] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:17:42] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:21:29] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:21:29] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:21:32] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:21:32] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:21:32] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:21:32] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:21:32] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:21:51] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:21:51] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 15:21:51] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 15:21:55] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:21:55] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 15:21:55] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:21:55] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:21:55] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:21:55] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:21:55] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM users LIMIT 10;...
[2025-12-18 15:21:55] [ERROR] [trace_id=-] [postgres.py:260] - Database error executing query: relation "users" does not exist
LINE 1: SELECT * FROM users LIMIT 10;
                      ^

[2025-12-18 15:21:55] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Lỗi thực thi query: relation "users" does not exist
LINE 1: SELECT * FROM users LIMIT 10;
                      ^

[2025-12-18 15:21:57] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 15:22:00] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 15:22:11] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:22:11] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 15:23:53] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:23:53] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 15:23:57] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 15:24:00] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:24:00] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM action LIMIT 10;...
[2025-12-18 15:24:01] [INFO] [trace_id=-] [postgres.py:256] - Query returned 9 rows
[2025-12-18 15:24:01] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 15:24:04] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:24:04] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 15:24:08] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:24:08] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 15:24:10] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9741)
[2025-12-18 15:24:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:24:16] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 15:24:28] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:24:28] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 15:24:28] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 15:24:31] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:24:31] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM action LIMIT 10;...
[2025-12-18 15:24:31] [INFO] [trace_id=-] [postgres.py:256] - Query returned 9 rows
[2025-12-18 15:24:31] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 15:24:39] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:24:39] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 15:25:27] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 15:25:27] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 15:25:27] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 15:25:28] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:25:28] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 15:25:30] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:25:30] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 15:25:31] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9991)
[2025-12-18 15:38:46] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 15:42:46] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:42:46] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:42:48] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:42:48] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:42:48] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:42:48] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:42:48] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:42:57] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:42:57] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:42:57] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:44:04] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 15:44:04] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 15:44:06] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 15:44:07] [INFO] [trace_id=-] [postgres.py:649] - Starting postgres-mcp-server...
[2025-12-18 15:44:07] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 15:44:07] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 15:44:07] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 15:44:15] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 15:44:15] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:44:15] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 15:44:19] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:44:19] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 15:44:22] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:44:22] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 15:44:23] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 15:44:28] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:44:28] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:44:28] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:44:28] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:44:36] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:44:36] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:44:37] [INFO] [trace_id=-] [postgres.py:376] - Tool called: list_tables
[2025-12-18 15:44:41] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:44:41] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:44:43] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:44:43] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 15:44:45] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 15:44:45] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 15:44:46] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8995)
[2025-12-18 15:44:51] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query
[2025-12-18 15:44:51] [ERROR] [trace_id=-] [postgres.py:447] - Tool call failed: Tool không xác định: query
[2025-12-18 15:45:00] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 16:32:32] [INFO] [trace_id=-] [postgres.py:680] - Connection pool closed
[2025-12-18 16:33:51] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 16:33:51] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 16:33:54] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 16:33:54] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 16:33:54] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 16:33:54] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 16:33:54] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 16:34:08] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 16:34:08] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:34:08] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 16:34:08] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 16:34:31] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 16:34:31] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 16:34:33] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 16:34:33] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 16:34:33] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 16:34:33] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 16:34:33] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 16:34:41] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 16:34:41] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:34:41] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 16:35:04] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 16:35:04] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 16:35:06] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 16:35:06] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 16:35:06] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 16:35:06] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 16:35:06] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 16:35:15] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 16:35:15] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:35:15] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 16:35:17] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:35:17] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 16:35:20] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:35:20] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 16:35:22] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 16:35:25] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:35:25] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:35:26] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:35:26] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 16:35:26] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 16:35:27] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:35:27] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 16:35:28] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 16:35:28] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 16:35:32] [INFO] [trace_id=-] [postgres.py:376] - Tool called: list_tables
[2025-12-18 16:35:39] [ERROR] [trace_id=-] [local_sentiment_model.py:244] - Tool call failed: Tool không xác định: predict_sentiment<|channel|>analysis
[2025-12-18 16:35:42] [ERROR] [trace_id=-] [local_sentiment_model.py:244] - Tool call failed: Tool không xác định: predict_sentiment<|channel|>analysis
[2025-12-18 16:35:46] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:35:48] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 16:35:50] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:35:50] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:35:53] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:35:53] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:36:07] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 16:52:19] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 16:56:01] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 16:56:01] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 16:56:03] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 16:56:03] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 16:56:03] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 16:56:03] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 16:56:03] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 16:56:12] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 16:56:12] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:56:12] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 16:58:57] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 16:58:57] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 16:58:58] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 16:58:58] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 16:58:58] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 16:58:58] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 16:58:58] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 16:59:05] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 16:59:05] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:59:05] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 16:59:09] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:59:09] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 16:59:11] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 16:59:11] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 16:59:13] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 16:59:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:59:16] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:59:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:59:16] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 16:59:17] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 16:59:20] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:59:20] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 16:59:20] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 16:59:20] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 16:59:33] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:59:33] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:59:36] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 16:59:36] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 16:59:38] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:08:19] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:08:52] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:08:52] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:08:54] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:08:54] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:08:54] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:08:54] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:08:54] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:09:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:09:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:09:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:10:38] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:10:38] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:10:40] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:10:40] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:10:40] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:10:40] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:10:40] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:10:47] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:10:47] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:10:47] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:10:50] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:10:50] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:10:50] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:10:50] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:10:50] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:10:53] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:10:53] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 17:10:53] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:10:53] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:10:57] [INFO] [trace_id=-] [postgres.py:376] - Tool called: list_tables
[2025-12-18 17:11:00] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:11:00] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM public.user;...
[2025-12-18 17:11:00] [INFO] [trace_id=-] [postgres.py:256] - Query returned 34 rows
[2025-12-18 17:11:00] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:11:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:11:04] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:11:07] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:11:07] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:11:10] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:12:20] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:13:45] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:13:45] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:13:48] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:13:48] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:13:48] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:13:48] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:13:48] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:13:57] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:13:57] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:13:57] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:14:36] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:14:36] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:14:43] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:14:43] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:14:43] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:14:43] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:14:43] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:15:10] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:15:10] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:15:10] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:15:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:16] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:15:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:16] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:15:16] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:15:17] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:17] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 17:15:17] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:15:17] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:15:19] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:19] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM users;...
[2025-12-18 17:15:19] [ERROR] [trace_id=-] [postgres.py:260] - Database error executing query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 17:15:19] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Lỗi thực thi query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 17:15:24] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:15:24] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 17:15:27] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:15:27] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 17:15:28] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 17:15:31] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:31] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:15:31] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:15:32] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:32] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:15:33] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:33] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 17:15:35] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:35] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:15:38] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:15:39] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:15:45] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:45] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:15:58] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:15:58] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:15:58] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:16:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:16:04] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: SQL query không được rỗng
[2025-12-18 17:16:06] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 17:16:06] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 17:16:06] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 17:16:07] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:16:07] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 17:16:10] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:16:10] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 17:16:11] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9016)
[2025-12-18 17:16:18] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:16:18] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT p.content, p.title FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post_id WHERE l.p...
[2025-12-18 17:16:18] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:16:27] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:16:28] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8459)
[2025-12-18 17:16:37] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:16:37] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9951)
[2025-12-18 17:16:38] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:16:38] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:17:00] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:00] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:17:00] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:17:07] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:07] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: SQL query không được rỗng
[2025-12-18 17:17:09] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:09] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 17:17:14] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:17:16] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:17:17] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-18 17:17:20] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:17:21] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-18 17:17:36] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:36] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:17:36] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:17:40] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:40] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: SQL query không được rỗng
[2025-12-18 17:17:48] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:17:48] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:27:17] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:28:09] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:28:09] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:28:11] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:28:11] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:28:11] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:28:11] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:28:11] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:28:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:28:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:28:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:29:32] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:29:32] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:29:32] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:29:40] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:29:40] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
    ...
[2025-12-18 17:29:46] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:29:53] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:29:53] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:30:12] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:30:12] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:30:12] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:30:16] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:30:16] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM analysis_posts
LIMIT 10;...
[2025-12-18 17:30:16] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:30:16] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:30:41] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:30:41] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:30:47] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:30:48] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:30:49] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:30:49] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:30:49] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:30:49] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:30:49] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:30:57] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:30:57] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:30:57] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:31:01] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:01] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:31:01] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:01] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:31:01] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:31:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:04] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 17:31:04] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:31:04] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:31:08] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:31:08] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 17:31:10] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:31:10] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 17:31:12] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 17:31:17] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:17] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:31:19] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:31:20] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8995)
[2025-12-18 17:31:28] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:28] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:31:30] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:31:36] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:36] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:31:36] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:31:41] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:41] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM analysis_posts LIMIT 10;...
[2025-12-18 17:31:41] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:31:41] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:31:45] [INFO] [trace_id=-] [postgres.py:376] - Tool called: describe_table<|channel|>commentary
[2025-12-18 17:31:45] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Tool không xác định: describe_table<|channel|>commentary
[2025-12-18 17:31:52] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:31:52] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:32:40] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:33:07] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:33:07] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:33:08] [INFO] [trace_id=-] [postgres.py:46] - Schema cache initialized with TTL: 300s
[2025-12-18 17:33:08] [INFO] [trace_id=-] [postgres.py:651] - Starting postgres-mcp-server...
[2025-12-18 17:33:08] [INFO] [trace_id=-] [postgres.py:94] - ✅ Database connection pool initialized
[2025-12-18 17:33:08] [INFO] [trace_id=-] [postgres.py:223] - Fetched schema for 52 tables
[2025-12-18 17:33:08] [INFO] [trace_id=-] [postgres.py:66] - Schema cache refreshed: 52 tables
[2025-12-18 17:33:15] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:33:15] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:33:15] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:35:38] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:35:38] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:35:38] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:35:42] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:35:42] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
    ...
[2025-12-18 17:35:47] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:35:57] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:35:57] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:37:04] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:37:04] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:37:04] [INFO] [trace_id=-] [postgres.py:256] - Query returned 574 rows
[2025-12-18 17:37:08] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:37:08] [INFO] [trace_id=-] [postgres.py:244] - Executing query: SELECT * FROM analysis_posts LIMIT 10;...
[2025-12-18 17:37:08] [INFO] [trace_id=-] [postgres.py:256] - Query returned 10 rows
[2025-12-18 17:37:08] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Object of type datetime is not JSON serializable
[2025-12-18 17:37:10] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 17:37:10] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 17:37:10] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 17:37:15] [INFO] [trace_id=-] [postgres.py:376] - Tool called: query_database
[2025-12-18 17:37:15] [ERROR] [trace_id=-] [postgres.py:449] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:46:11] [INFO] [trace_id=-] [postgres.py:682] - Connection pool closed
[2025-12-18 17:46:34] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:46:34] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 17:46:34] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 17:46:36] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:46:47] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 17:46:50] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:46:50] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 17:46:53] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:46:53] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 17:46:54] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 17:47:00] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:00] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:47:00] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:00] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:47:00] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:47:03] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:03] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 17:47:03] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:47:12] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:12] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:47:23] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:23] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:47:24] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:24] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:47:24] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:47:26] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 17:47:27] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:27] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 17:47:32] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:47:36] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:36] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-18 17:47:40] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:40] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:47:57] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:47:57] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:47:57] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:48:01] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:48:01] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM analysis_posts ORDER BY pub_time DESC LIMIT 10;...
[2025-12-18 17:48:01] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:48:04] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 17:48:21] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:48:21] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:48:21] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:48:26] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:48:26] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM analysis_posts LIMIT 10;...
[2025-12-18 17:48:26] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:48:28] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 17:48:28] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 17:48:28] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 17:48:38] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:48:38] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:49:06] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:06] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:49:06] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:49:14] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:14] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM analysis_posts
ORDER BY pub_timestamp DESC
LIMIT 10;...
[2025-12-18 17:49:14] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:49:17] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:17] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-18 17:49:17] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: column "p.pub_time" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...GROUP BY p.content, l.sentiment, p.title ORDER BY p.pub_time...
                                                             ^

[2025-12-18 17:49:17] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: column "p.pub_time" must appear in the GROUP BY clause or be used in an aggregate function
LINE 1: ...GROUP BY p.content, l.sentiment, p.title ORDER BY p.pub_time...
                                                             ^

[2025-12-18 17:49:21] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:21] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment
FROM (
  SELECT id, content, title, pub_time
  FROM tbl_posts...
[2025-12-18 17:49:21] [INFO] [trace_id=-] [postgres.py:267] - Query returned 0 rows
[2025-12-18 17:49:41] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:41] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:49:41] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:49:44] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:44] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 17:49:49] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 17:49:59] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:49:59] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 17:50:31] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:50:31] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 17:50:31] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 17:50:36] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 17:50:36] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT json_agg(row_to...
[2025-12-18 17:50:36] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at end of input
LINE 1: SELECT json_agg(row_to
                              ^

[2025-12-18 17:50:36] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at end of input
LINE 1: SELECT json_agg(row_to
                              ^

[2025-12-18 17:50:41] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:50:41] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 17:50:44] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 17:50:44] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 17:50:46] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-18 18:01:58] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 18:03:10] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 18:03:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 18:03:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 18:03:18] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 18:04:20] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 18:04:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:04:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:04:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 18:04:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 18:04:23] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:04:23] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 18:04:25] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:04:25] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:04:27] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 18:04:47] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:04:47] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:04:47] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:04:47] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:04:47] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:05:05] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:05] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:05:05] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:05:05] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:05:06] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:06] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM users;...
[2025-12-18 18:05:06] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 18:05:06] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 18:05:09] [INFO] [trace_id=-] [postgres.py:387] - Tool called: list_tables
[2025-12-18 18:05:14] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:14] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-18 18:05:14] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 18:05:18] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database<|channel|>commentary
[2025-12-18 18:05:18] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Tool không xác định: query_database<|channel|>commentary
[2025-12-18 18:05:23] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:23] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:05:24] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:05:39] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:39] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 18:05:41] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:41] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:05:41] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:41] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:05:41] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:05:41] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:05:42] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 18:05:46] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:47] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 18:05:51] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:51] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 18:05:52] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:52] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:05:53] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:53] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:05:54] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7750)
[2025-12-18 18:05:55] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:05:56] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8995)
[2025-12-18 18:05:58] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:05:58] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-18 18:06:03] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 18:06:23] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:06:23] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:06:40] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:06:40] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:06:51] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 18:07:26] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:07:26] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:07:26] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:07:43] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:07:43] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:07:43] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:07:43] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:07:54] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 18:07:54] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 18:07:54] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 18:08:01] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 18:08:01] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 18:08:03] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 18:08:03] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 18:08:03] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 18:08:03] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 18:08:03] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 18:08:05] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:05] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-18 18:08:12] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 18:08:12] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:08:12] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 18:08:16] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:08:16] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 18:08:18] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:08:18] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:08:19] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-18 18:08:34] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:34] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:08:34] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:34] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:08:34] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:08:35] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:35] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:08:35] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:08:44] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:44] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:08:44] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:08:44] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:08:46] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:46] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:08:46] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:08:46] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:08:46] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 18:08:46] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 18:08:46] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 18:08:47] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:47] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM users;...
[2025-12-18 18:08:47] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 18:08:47] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: relation "users" does not exist
LINE 1: SELECT * FROM users;
                      ^

[2025-12-18 18:08:48] [INFO] [trace_id=-] [postgres.py:387] - Tool called: list_tables
[2025-12-18 18:08:49] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:08:49] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 18:08:50] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:50] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM public.user;...
[2025-12-18 18:08:50] [INFO] [trace_id=-] [postgres.py:267] - Query returned 34 rows
[2025-12-18 18:08:52] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:08:52] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:08:53] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7750)
[2025-12-18 18:08:56] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:08:56] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 18:09:00] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:09:00] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 18:09:01] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 18:09:02] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 18:09:02] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 18:09:02] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 18:09:07] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:09:07] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:09:08] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:09:08] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-18 18:09:10] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:09:10] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:09:11] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-18 18:09:15] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:09:15] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:09:17] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 18:09:17] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 18:09:17] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 18:09:19] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:09:20] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8995)
[2025-12-18 18:09:33] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:09:33] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:09:40] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 18:11:39] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 18:13:11] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 18:13:11] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 18:13:13] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 18:13:13] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 18:13:13] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 18:13:13] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 18:13:13] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 18:13:22] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 18:13:22] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:13:22] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 18:13:53] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:13:53] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:13:53] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:19:14] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 18:19:14] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 18:19:15] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 18:19:15] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 18:19:15] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 18:19:15] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 18:19:16] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 18:19:25] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 18:19:25] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:19:25] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 18:20:48] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:20:48] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:20:48] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:21:12] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:21:12] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:21:13] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:21:13] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:21:15] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-18 18:21:15] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-18 18:21:15] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-18 18:21:20] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:21:20] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-18 18:21:25] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-18 18:21:25] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-18 18:21:27] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7750)
[2025-12-18 18:21:39] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:21:39] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-18 18:21:44] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 18:21:59] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:21:59] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 18:22:32] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:22:32] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 18:22:32] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 18:22:49] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:22:49] [INFO] [trace_id=-] [postgres.py:255] - Executing query: Maximum iterations reached. Please try rephrasing your question....
[2025-12-18 18:22:49] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:22:49] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at or near "Maximum"
LINE 1: Maximum iterations reached. Please try rephrasing your quest...
        ^

[2025-12-18 18:22:51] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 18:22:51] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-18 18:22:56] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 18:23:32] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 20:52:44] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 20:52:45] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 20:52:49] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 20:52:49] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 20:52:49] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 20:52:49] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 20:52:49] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 20:53:28] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 20:53:28] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 20:53:28] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 20:59:23] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 21:00:54] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 21:00:54] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 21:00:57] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 21:00:57] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 21:00:57] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 21:00:57] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 21:00:57] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 21:01:20] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 21:01:20] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 21:01:20] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 21:03:34] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 21:05:59] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 21:05:59] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 21:06:03] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 21:06:03] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 21:06:03] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 21:06:03] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 21:06:03] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 21:06:34] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 21:06:34] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 21:06:34] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 21:07:52] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-18 21:09:24] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-18 21:09:24] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-18 21:09:27] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-18 21:09:27] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-18 21:09:27] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-18 21:09:27] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-18 21:09:27] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-18 21:09:46] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-18 21:09:46] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-18 21:09:46] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-18 21:10:33] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 21:10:33] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 21:10:33] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 21:10:38] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 21:10:38] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-18 21:10:43] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-18 21:10:47] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 21:10:47] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-18 21:10:58] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 21:10:58] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-18 21:10:58] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-18 21:11:01] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-18 21:11:01] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: SQL query không được rỗng
[2025-12-18 21:11:44] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-19 08:55:21] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-19 08:55:21] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-19 08:55:23] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-19 08:55:23] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-19 08:55:23] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-19 08:55:23] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-19 08:55:23] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-19 08:55:36] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-19 08:55:36] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 08:55:36] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-19 08:56:53] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:56:53] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 08:56:53] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 08:56:58] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:56:58] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l ON p...
[2025-12-19 08:57:02] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 08:57:05] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-19 08:57:05] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-19 08:57:05] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-19 08:57:13] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:57:13] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-19 08:57:17] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:57:17] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 08:58:04] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:58:04] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 08:58:04] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 08:58:08] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:58:08] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM analysis_posts LIMIT 10;...
[2025-12-19 08:58:08] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 08:58:11] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 08:58:11] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-19 08:58:13] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 08:58:13] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 08:58:15] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEU (confidence: 0.9335)
[2025-12-19 08:58:26] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:58:26] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 08:59:21] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 08:59:22] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9777)
[2025-12-19 08:59:25] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:59:25] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 08:59:46] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:59:46] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 08:59:46] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 08:59:52] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:59:52] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT json_agg(row_to_json(t)) AS result_json
FROM (
  SELECT table_name, column_name, data_type
  ...
[2025-12-19 08:59:52] [INFO] [trace_id=-] [postgres.py:267] - Query returned 1 rows
[2025-12-19 08:59:55] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 08:59:55] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM analysis_posts LIMIT 5;...
[2025-12-19 08:59:55] [INFO] [trace_id=-] [postgres.py:267] - Query returned 5 rows
[2025-12-19 08:59:59] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 08:59:59] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-19 09:00:00] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:00:00] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 09:00:01] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.8496)
[2025-12-19 09:00:13] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:00:14] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9941)
[2025-12-19 09:00:35] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:00:35] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:00:35] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:00:40] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:00:40] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT id, code, name, create_time, modify_time, created_at, updated_at
FROM action
ORDER BY create_...
[2025-12-19 09:00:40] [INFO] [trace_id=-] [postgres.py:267] - Query returned 9 rows
[2025-12-19 09:02:13] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:02:13] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:02:13] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:02:16] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:02:16] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
    ...
[2025-12-19 09:02:16] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: column p.created_at does not exist
LINE 14: ORDER BY p.created_at DESC
                  ^

[2025-12-19 09:02:16] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: column p.created_at does not exist
LINE 14: ORDER BY p.created_at DESC
                  ^

[2025-12-19 09:02:26] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:02:26] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:02:51] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-19 09:03:09] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-19 09:03:09] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-19 09:03:10] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-19 09:03:10] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-19 09:03:10] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-19 09:03:10] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-19 09:03:10] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-19 09:03:18] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-19 09:03:18] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:03:18] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-19 09:03:18] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-19 09:03:33] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-19 09:03:33] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-19 09:03:34] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-19 09:03:34] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-19 09:03:34] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-19 09:03:34] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-19 09:03:34] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-19 09:03:41] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-19 09:03:41] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:03:41] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-19 09:03:49] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:03:49] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:03:49] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:03:55] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:03:55] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-19 09:04:00] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 09:04:04] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:04] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-19 09:04:08] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 09:04:11] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:11] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:04:32] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:32] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:04:32] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:04:35] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:35] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT json_agg(row_to_json(t)) AS result
FROM...
[2025-12-19 09:04:35] [ERROR] [trace_id=-] [postgres.py:271] - Database error executing query: syntax error at end of input
LINE 2: FROM
            ^

[2025-12-19 09:04:35] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Lỗi thực thi query: syntax error at end of input
LINE 2: FROM
            ^

[2025-12-19 09:04:36] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-19 09:04:36] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-19 09:04:36] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-19 09:04:38] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:38] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
    ON p.id = l....
[2025-12-19 09:04:43] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 09:04:44] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:04:44] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-19 09:04:47] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:04:47] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 09:04:47] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-19 09:04:49] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:04:50] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7826)
[2025-12-19 09:04:51] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:04:51] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9493)
[2025-12-19 09:04:53] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:04:54] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.4983)
[2025-12-19 09:04:54] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:04:54] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:04:54] [INFO] [trace_id=-] [sentiment.py:45] - ✅ Đang sử dụng OpenRouter với model: openai/gpt-oss-20b
[2025-12-19 09:04:54] [INFO] [trace_id=-] [sentiment.py:177] - Use handle tool
[2025-12-19 09:04:56] [INFO] [trace_id=-] [postgres.py:51] - Schema cache initialized with TTL: 300s
[2025-12-19 09:04:56] [INFO] [trace_id=-] [postgres.py:674] - Starting postgres-mcp-server...
[2025-12-19 09:04:56] [INFO] [trace_id=-] [postgres.py:99] - ✅ Database connection pool initialized
[2025-12-19 09:04:56] [INFO] [trace_id=-] [postgres.py:228] - Fetched schema for 52 tables
[2025-12-19 09:04:56] [INFO] [trace_id=-] [postgres.py:71] - Schema cache refreshed: 52 tables
[2025-12-19 09:05:02] [INFO] [trace_id=-] [local_sentiment_model.py:258] - Starting HF Local MCP Server...
[2025-12-19 09:05:02] [INFO] [trace_id=-] [local_sentiment_model.py:259] - Default model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:02] [INFO] [trace_id=-] [local_sentiment_model.py:260] - Default device: cpu
[2025-12-19 09:05:05] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:05] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: auto
[2025-12-19 09:05:08] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:08] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 09:05:09] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9116)
[2025-12-19 09:05:12] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:12] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:05:12] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:12] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:05:12] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:05:14] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:14] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT * FROM "user" LIMIT 10;...
[2025-12-19 09:05:14] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 09:05:17] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:17] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-19 09:05:19] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:19] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 09:05:19] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7258)
[2025-12-19 09:05:22] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:22] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:05:23] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:24] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.8995)
[2025-12-19 09:05:27] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:27] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:05:29] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
[2025-12-19 09:05:49] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:49] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:05:49] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:05:52] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:52] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: SQL query không được rỗng
[2025-12-19 09:05:53] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-19 09:05:53] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-19 09:05:53] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-19 09:05:56] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:05:57] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-19 09:05:59] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:05:59] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Pattern không an toàn được phát hiện: --
[2025-12-19 09:06:01] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:01] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT 
    p.content,
    p.title,
    l.sentiment
FROM tbl_posts p
JOIN tbl_trans_detail_log l
   ...
[2025-12-19 09:06:07] [INFO] [trace_id=-] [postgres.py:267] - Query returned 10 rows
[2025-12-19 09:06:10] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:06:11] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7826)
[2025-12-19 09:06:13] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:06:13] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9493)
[2025-12-19 09:06:13] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:13] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:06:33] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:33] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:06:33] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:06:38] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:38] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: SQL query không được rỗng
[2025-12-19 09:06:39] [INFO] [trace_id=-] [sentiment.py:133] - Calling LLM for sentiment analysis...
[2025-12-19 09:06:39] [ERROR] [trace_id=-] [sentiment.py:162] - Sentiment analysis failed: 'ChatOpenAI' object is not callable
[2025-12-19 09:06:39] [ERROR] [trace_id=-] [sentiment.py:240] - Sentiment tool error
Traceback (most recent call last):
  File "C:\Users\tung0\Desktop\For Work\Abp\AI_Agent\mcp\MCP-SERVER-POSTGRES\sentiment.py", line 236, in handle_call_tool
    text=result["label"],
         ~~~~~~^^^^^^^^^
KeyError: 'label'
[2025-12-19 09:06:43] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:43] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT p.content, p.title, l.sentiment FROM tbl_posts p JOIN tbl_trans_detail_log l ON p.id = l.post...
[2025-12-19 09:06:47] [INFO] [trace_id=-] [postgres.py:267] - Query returned 5 rows
[2025-12-19 09:06:49] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:06:50] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.6785)
[2025-12-19 09:06:52] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:06:52] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.7826)
[2025-12-19 09:06:55] [INFO] [trace_id=-] [local_sentiment_model.py:56] - Using cached model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:06:55] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: NEG (confidence: 0.9493)
[2025-12-19 09:06:58] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:06:58] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:08:12] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:08:12] [INFO] [trace_id=-] [postgres.py:255] - Executing query: SELECT table_name, column_name, data_type 
                FROM information_schema.columns 
        ...
[2025-12-19 09:08:12] [INFO] [trace_id=-] [postgres.py:267] - Query returned 574 rows
[2025-12-19 09:08:17] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:08:17] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'update' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:08:18] [INFO] [trace_id=-] [local_sentiment_model.py:59] - Loading model: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:08:18] [INFO] [trace_id=-] [local_sentiment_model.py:60] - Device: cpu
[2025-12-19 09:08:20] [INFO] [trace_id=-] [local_sentiment_model.py:79] - ✅ Model loaded successfully: TungCan/tuning-sentiment-abp-pos
[2025-12-19 09:08:20] [INFO] [trace_id=-] [local_sentiment_model.py:80] -    Labels: {0: 'NEG', 1: 'POS', 2: 'NEU'}
[2025-12-19 09:08:21] [INFO] [trace_id=-] [local_sentiment_model.py:137] - Prediction: POS (confidence: 0.9039)
[2025-12-19 09:08:23] [INFO] [trace_id=-] [postgres.py:387] - Tool called: query_database
[2025-12-19 09:08:23] [ERROR] [trace_id=-] [postgres.py:472] - Tool call failed: Thao tác 'insert' không được phép. Chỉ cho phép câu lệnh SELECT.
[2025-12-19 09:58:45] [INFO] [trace_id=-] [postgres.py:705] - Connection pool closed
